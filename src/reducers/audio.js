import {
  INITIALIZE,
  UPDATE_VOLUME, NEXT, PREVIOUS,
  PLAY, SET_TIME, SET_PROGRESS,
  TOGGLE_FAVORITE, TOGGLE_REPEAT,
  UPDATE_POSITION, PAUSE
} from '../constants/ActionTypes'

import find from 'lodash/find';
import findIndex from 'lodash/findIndex';
import sortBy from 'lodash/sortBy';
import indexOf from 'lodash/indexOf';
import clone from 'lodash/clone';

const initialState = {
  isPlaying: false,
  isFavorite: false,
  isRepeating: false,
  percent: 0,
  volume: 65,
  progress: {},
  duration: 0,
  repeat: false,
  songs: [],
  currentID: null,
  autoplay: false,
  defaultSong: {
    "id": -1,
    "coverURL": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAASABIAAD/4QBARXhpZgAATU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAB9KADAAQAAAABAAAB9AAAAAD/7QA4UGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAAA4QklNBCUAAAAAABDUHYzZjwCyBOmACZjs+EJ+/8AAEQgB9AH0AwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/bAEMAAQEBAQEBAgEBAgMCAgIDBAMDAwMEBQQEBAQEBQYFBQUFBQUGBgYGBgYGBgcHBwcHBwgICAgICQkJCQkJCQkJCf/bAEMBAQEBAgICBAICBAkGBQYJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCf/dAAQAIP/aAAwDAQACEQMRAD8A/l/ooorxznCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9D+X+iiivHOcKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0f5f6KKK8c5wooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//S/l/ooorxznCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9P+X+iiivHOcKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1P5f6KKK8c5wooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//V/l/ooorxznCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9b+X+iiivHOcKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1/5f6KKK8c5wooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//Q/l/ooorxznCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9H+X+iiivHOcKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0v5f6KKK8c5wooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAor720vwL/wAE9ZdNt5NU8aeIkuWiQyqIcAOQNwAFk4GD6M31PWuL+KXhL9izS/BF5e/CjxTreo68uz7Nb3UWIXy4D7ybWHAC5Od+c44PSuGOPTly8svuZ8Zh+NadSsqKw9ZXdrulJL1btovM+PaK2vDkOhXHiGwg8UTS2+mPcRLdywqGkSAsBIyKeCwXJA9a+6v+EC/4Jz/9Dt4j/wC/R/8AkCta+JVO1036K56WdcRQwMoxlSqTv/JCUrettj8+6K+m/jd4b/ZW0Xw9az/AnxDq2r6k9xtnivo9sSwbWywY28B3btoAG7IJ6Y58j+F9j8OdS8cWVl8WL2607QXL/abizUPMmEJTAKvwXwCQjHHaqp11KHPZ/dr9x0YPOo1sI8Wqc0lf3XFqWnaL1d+nc4Civ0E/4QL/AIJz/wDQ7eI/+/R/+QKofHn9lb4deF/g5Y/Hf4K65c6hocxVZE1LasziSTyleLEUROG4ZCmcfMDgGuaOZQ5lGSav3TR89R8QMG69OhWp1Kbm+WLnTlFOT2V2t30PgqiiivQPugooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP//T/l/ooorxznCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK+5/wBjjwz4d1/wr8T7jXLGC8e18OymFpo1cxkpKdybgdpyqnI5GBXwxX2j+yX8QvBngjwz8R7LxXqEVjLqmgSw2iyEjzpdki7E45YlxgdT+BrhzJSdF8u+n5o+M8QKdaWU1I4dNyvDa9/jjfbyPi6iiiu4+zCiiigAooooAK9J8Q6z8VbvwFo+l+Jjfnw5bsx00TxuttuOd3ksVCseucE9682r6f8AiR8bfDPjL9nvwZ8JNOtrqPUPDckr3EsioIXEhbHlkOWP3hnKisKzfNGyvr92h4uazqKtQVOkppy1f8i5Ze8vnZfM898D/A34jfEfwXrPjrwbZi+tNCKi5jRwZ8MCxKRfeYKBk459AcHHkVet/Bj4z+Mvgb4zh8YeEJfRLm2cnyrmLPMbgf8AjrdVPI9/qL9oX4cfDH4n/D2X9qT4JSxWcHmRrrmksQr29xMwTcijgFnYZA4YHev8QrCWJlCry1F7r2fn2f6Hj4nP8Rg8xVDGxXsajShNX0k9OSfq/hls9j4CoooruPsgooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//U/l/ooorxznCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKtW1je3qytZwvKIUMkhRS2xBwWbA4UZHJ4qrX6AfsRxo3hD4rMygn/hG5RyOxjmyPxrmxeI9lTc7f1c8DifO3l2CnjFHm5eXS9t5Jfqfn/RRRXSe+FFFFABRRRQAV96z/sgap4w/Z98H/ED4SaZc6nreqmVtQXz41jVFZ1UqshTHIHQmvgqvR/D/wAYfi14T0uPQ/C/ifVdOsoiSlvbXk0USljk7UVgoyTk4HWuXFU6srOk7NM+b4kwOYVo0pZdUUJRld813GSs1Z2ae7T+RR8BfDXxv8TvELeFPAlg2oagsbymFXRDsQgMcuyrwSO9L43+G/jj4b+JB4M8a2LWGosqP5DOjEiT7hyjMvP1rH8N+LvFXg7UzrfhLUrrS7wqUM9rM8Mm1sErvQg4OBkd6PEPi7xV4t1Ya/4p1K61K+AVRcXMzyy4T7o3uS2B254rT95z9OX8Tv5cb9avePsrdnzc3re1vlc961b9jn9ovQfDWoeK9Y8OvBa6bH5so86F5DGMlmVI3YsEAy2OcevOPmOv09/Yi+J3xI8c+IPF+neNNf1HV7eLw/cSJHeXMs6K+9BuCyMwBwSMjsa/MKubCV6jnOnVtdW28z57hfOMwq4vE4LMORyp8jTgmlaSb6t7W/EKKKK7z7YKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//9X+X+iiivHOcKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr6t/Zp+MfhD4V6B480zxSZhJ4g0WSztPKTeDMVdVVuflB39TwMH8flKur8M+BvF3jKDULnwtp819HpVs13dtEuRFCn3nb2H54B44NYYmlGcHGex43EGX4bFYSVDFu0Ha7vbZprX1SOUooorc9kKKKKACiiigAooooAKKKKAO58C/Enxv8NLq9vfA9++ny6hayWVwyqjb4JMbl+dWweAQwww7EVw1fUP7LfwU8M/GzXfEOl+J57iBNL0ae9gNuVU+crKqFtytlRuJIGM8c+vy9WEKkHOUVurXPGweNws8ZXo0l+8jy8ztvdPl162V/QKKKK3PZCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/W/l/ooorxznCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/QP9iH/kT/AIrf9i5L/wCi5q/Pyvor4EfHK0+Duj+MNKu9Pe9/4SbSpLCNkcJ5UjKyqzZByvzknHPArizClKdFxjvp+aPkeOstrYvK6mHw8bybjZek4t7+SZ860UUV2n1wUUUUAFFFFABRRRQAUUUUAfoF/wAE+CB4w8ZE/wDQuXH/AKMjr8/a1dJ17XNBkml0K8nsmuImt5TBI0Zkif78bFSNyN3U8HuKyq5qdDlqSqX3t+B8/l+SSoZhiMa5XVXk07cqa/G4UUUV0n0AUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQB/9f+X+iiivHOcKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr074d/CLxn8ULHXNR8KRRvF4esnv7syOE/dICSE9WIBIHHTr0z5jX6B/sQ/8if8AFb/sXJf/AEXNXJjq7p0nOPl+Z8xxjnFXAZdPFULcycd9tZJP8Gfn5RRRXWfThRRRQAUUUUAFFFFABRRRQB9ifsb/AAw8E/FDxJ4osPG9mL2Ky0K4uIAXZPLmDIokG0j5lBOM5HtXx3X3p+wPqmmaX4t8Yy6lcR26nw3dEGRgoIV4ycZPYcmvguuGhKTr1E9tP1PjMmr1pZzjac2+VKnZdFdSvb9QoooruPswooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9D+X+iiivHOcKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr2f4S/G3xB8IdM8S6XolrBcp4l059PmM27MYcMN6bSMkBm4PGceleMV7l8Hfgfqnxh0vxRqmn30VmvhnTX1BxIpYzbAzCMYI25Cn5ucccHPGGJ9nyP2mx43EDwSwknmFvZ6Xvfurbedjw2iiitz2QooooAKKKKACiiigAooooAKK+5/2FPDPh3xN4r8X2/iKxgvkj8O3LIs8ayBSXQFl3A4OCRkc4718MVz066lUlTttb8TxMFnUa+Nr4JRs6XLr35k3+FgoooroPbCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0f5f6KKK8c5wooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACv0D/Yh/5E/wCK3/YuS/8Aouavz8r0TwJ8VPG3w2s9ZsPCN0LeLXrNrG8BRX3wvkHG4Ha2CQGHIya5MbQdSk4R8vzPmeMMmq5hl88JRaUm477aST/JHndFFFdZ9MFFFFABRRRQAUUUUAFFFFAH2j+xX8QfBvw98TeK73xnqEWnxXWgXMMLSnAkk3owRfViAcDqe1fF1WrWyvb4utlC8xiQyOEUttRerHHQDuegqrWFOgo1JTW7t+B42DyenRxlfGRfvVOW67cqaVvW4UUUVueyFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAf//S/l/ooorxznCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK+pv2Z/2erT4+xeKrdrmeK90fTjcWMUOwedctu8tHL8bSVwcFeudwxz8s10nhnxl4v8FXj6h4N1W80m4lTy3lsp5IHZM52lo2UkZGcE4rDEQnKDVN2Z5GfYXFVsJOngqnJUdrNq6Wqe3mtPmejfEX9nX4z/AAn0WPxF8QNCl0+yllECzGSGVfMYEhT5TuRkA4zgV554O8G+JviD4ltfCHg60a+1K9LCGBCoLbVLtyxCgBVJJJAAFaHib4m/EjxrZpp3jLxDqWrW8b+YkV7dzTor4I3BZHYA4JGRzzXN6PrWseHtTh1rw/dzWN5bndFPbyNFKhxjKuhDA4OODRTVXk963N+BOCjmCwrWIlD2utmlLl8rptv119D6W/4Yl/ah/wChUk/8CbX/AOPV5N8S/gv8T/g9LaQ/EjSZNLN+Ha3LPHIr+Xjfho2cZXcMgnPI4q3/AML++O//AEO2vf8Agyuv/jlcd4o8deN/HEsM/jTWb7WHtwVia9uJbgoGwSFMjNtBwM461lRWI5v3jVvJP/M8zK6eequnjZ0nDryxmn5Wbk1v5Gt8OfhZ4/8Ai1rMugfDzTX1O7giM8iIyIFjBC7i0jKo5IHXJ7V7T/wxL+1D/wBCpJ/4E2v/AMer538NeLfFXgy/Oq+D9Tu9JumQxmazmkgkKEglS0bKcEgZGccV3X/C/vjv/wBDtr3/AIMrr/45RWWI5v3bVvNP/MvNqedutfAzpKH96M27/KSX4HN/ED4b+N/hZr//AAi/j/T302/8tZhE5VsxvkKwZGZSCQRweoI6iuj+GnwL+K/xggurn4caNJqcdkyrM6yRRqrOCVGZXQE4HQZx361wPiHxP4l8XakdZ8V6jc6peMoUz3czzyFV6AvIWbA7DPFaXhf4gePPA4mHgrW7/RxcY837Fcy2/mbc7d3lsu7GTjPTNayVXk0tzfgehXjmH1NKlKHttNWpcl+ul7+mp73/AMMS/tQ/9CpJ/wCBNr/8er508T+GNe8GeILrwt4otms9QsnMc8L43Iw5xkEg8cggkEciu9/4X98d/wDodte/8GV1/wDHK8y1PVNT1vUJtW1m4lu7u4YvLNM7SSOx6szsSWJ7kmooKtf9618r/wCZy5LDN1N/2jKm4205FJO/nzSeh+kH7AfgHxTbw+K/iJe2LLol3ol3ZRXTFdryqyMyBc7iMA5ONvGM5r80a7HSfiJ8QNA0ObwzoWu6hZabc7vNtILqWOCTeNrb41YI24cHI5HBrjqVDDyjUnUk97fgY5Nklehj8Vja0k1V5bJJ6KKaV7t669AooorrPqQooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/0/5f6KKK8c5wooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//U/l/ooorxznCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9X+X+iiivHOcKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1v5f6KKK8c5wooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//X/l/ooorxznCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9D+X+iiivHOcKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0f5f6KKK8c5wooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//S/l/ooorxznCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9P+X+iiivHOcKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1P5f6KKK8c5wooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//V/l/ooorxznCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9b+X+iiivHOcKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/2Q==",
    "audioFile": null,
    "title": "Waiting...",
    "artist": "No song loaded",
    "favorite": false
  }
};

function getSongIndex(songs, id) {
  return findIndex(songs, (o) => o.id === id);
}

function getAdjacentSong(songs, startIndex, direction) {
  let nextIndex = startIndex + direction;
  nextIndex = nextIndex < 0 ? songs.length-1 : nextIndex > songs.length-1 ? 0 : nextIndex;
  return songs[nextIndex].id;
}

export default function audio(state = initialState, action) {
  switch (action.type) {
    case INITIALIZE:
      const songsArray = sortBy(action.songs, ['id']);
      return {...state, songs: songsArray, currentID: songsArray[0].id };
    case PLAY:
    case PAUSE:
      return {...state, isPlaying: action.isPlaying, autoplay: true };
    case NEXT:
      return {
        ...state,
        currentID: getAdjacentSong(state.songs, getSongIndex(state.songs, state.currentID), 1),
        isPlaying: action.isPlaying
      };
    case PREVIOUS:
      return {
        ...state,
        currentID: getAdjacentSong(state.songs, getSongIndex(state.songs, state.currentID), -1),
        isPlaying: action.isPlaying
      };
    case UPDATE_VOLUME:
      return {...state, volume: action.volume };
    case SET_TIME:
      return {...state, percent: action.percent };
    case UPDATE_POSITION:
      return {...state, percent: action.percent };
    case SET_PROGRESS:
      return {...state, progress: action.progress, duration: action.duration };
    case TOGGLE_FAVORITE:
      const songs = state.songs.map(clone);
      const song = find(songs, {id: state.currentID});
      song.favorite = !song.favorite;
      return {...state, songs };
    case TOGGLE_REPEAT:
      return {...state, isRepeating: !state.isRepeating };
    default:
      return state
  }
}
